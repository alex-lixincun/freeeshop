@using Final_eshop_xincunli.Models
@model List<Final_eshop_xincunli.Models.IProduct>
<div class="errorMessageContent"></div>
@if (Model.Count > 0)
{
    Member m = MemberManage.Get(User.Identity.Name);
    <table id="cartList" class="table table-striped table-bordered">
        <thead>
            <tr>
                <th>
                    @Html.DisplayNameFor(model => model[0].Product.ProductName)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model[0].Amount)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model[0].Price)
                </th>
                @if (m.Role == Role.Premium)
                {
                    <th>
                        @Html.DisplayNameFor(model => model[0].Product.Discount)
                    </th>
                }
                <th>
                    @Html.DisplayNameFor(model => model[0].Product.Tax)
                </th>
            </tr>
        </thead>
        <tbody>
            @{
                double total = 0;
                double tax = 0;
                double totaltax = 0;}
            @for (int i = 0; i < Model.Count(); i++)
            {
                tax = Math.Round(Model[i].Price * Model[i].Product.Tax / 100, 2);
                totaltax += tax;
                total += (m.Role == Role.Premium ? (Model[i].Price * Model[i].Product.Discount / 100) : Model[i].Price) + totaltax;
                <tr class="cartList-item">
                    @Html.HiddenFor(model => Model[i].Id)
                    <td class="cart-item-title">
                        @Html.DisplayFor(model => Model[i].Product.ProductName)
                    </td>
                    <td class="cart-item-amount">
                        @Html.DisplayFor(model => Model[i].Amount)
                    </td>
                    <td class="cart-item-price">
                        <span class="price">@Html.DisplayFor(model => Model[i].Price)</span>
                    </td>
                    @if (m.Role == Role.Premium)
                    {
                        <td>
                            @Html.DisplayFor(model => Model[i].Product.Discount)
                        </td>
                    }
                    <td class="cart-item-price">
                        <span class="price">@tax</span>
                    </td>
                </tr>
            }
        </tbody>
        <tfoot>
            <tr>
                <td colspan="5">
                    <span class="cartTotal">Tax of: $@Math.Round(totaltax, 2)</span>
                </td>
            </tr>
            <tr>
                <td colspan="5">
                    <span class="cartTotal">Order Total: $@Math.Round(total, 2)</span>
                </td>
            </tr>
        </tfoot>
    </table>
                        }
                        else
                        {
                            <p class="notContent">
                                No Products
                            </p>
                        }
